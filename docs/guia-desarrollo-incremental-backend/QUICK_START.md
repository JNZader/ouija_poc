# Quick Start Guide - Backend Simple Ouija Virtual

## TL;DR - Inicio R√°pido

```bash
# 1. Clonar proyecto
cd backend-simple

# 2. Instalar dependencias
npm install

# 3. Setup base de datos
npx prisma generate
npm run prisma:seed

# 4. Ejecutar en desarrollo
npm run start:dev

# 5. Probar endpoint
curl -X POST http://localhost:3000/ouija/ask \
  -H "Content-Type: application/json" \
  -d '{"question": "¬øEncontrar√© el amor?", "personality": "wise", "language": "es"}'
```

## Roadmap Visual de 4 Semanas

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     DESARROLLO INCREMENTAL                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

SEMANA 1: Iteraci√≥n 1 - Base S√≥lida
‚îú‚îÄ Lun-Mar: Seed SQLite + FallbackService
‚îú‚îÄ Mi√©-Jue: Categorizaci√≥n + Tests
‚îú‚îÄ Vie:     Swagger + Docker
‚îî‚îÄ ‚úÖ DEMO: Sistema funcional sin IA

SEMANA 2: Iteraci√≥n 2 - Ollama Local
‚îú‚îÄ Lun:     Docker Compose con Ollama
‚îú‚îÄ Mar-Mi√©: Integraci√≥n + Retry logic
‚îú‚îÄ Jue:     Health checks + Logging
‚îú‚îÄ Vie:     Tests integraci√≥n
‚îî‚îÄ ‚úÖ DEMO: IA local funcionando

SEMANA 3: Iteraci√≥n 3 - Groq Cloud
‚îú‚îÄ Lun-Mar: GroqService + Fallback triple
‚îú‚îÄ Mi√©:     Rate limiting
‚îú‚îÄ Jue:     Dashboard m√©tricas
‚îú‚îÄ Vie:     Tests E2E
‚îî‚îÄ ‚úÖ DEMO: Sistema completo local

SEMANA 4: Iteraci√≥n 4 - Producci√≥n
‚îú‚îÄ Lun-Mar: Dockerfile + GitHub Actions
‚îú‚îÄ Mi√©:     Deploy Koyeb
‚îú‚îÄ Jue:     Monitoring + Documentaci√≥n
‚îú‚îÄ Vie:     Testing producci√≥n
‚îî‚îÄ üöÄ GO LIVE: Sistema en producci√≥n
```

## Iteraciones en 1 Minuto

### Iteraci√≥n 1: SQLite Base (1-2 semanas)
**¬øQu√© construyes?** Sistema que responde preguntas usando SQLite

**Tecnolog√≠as**:
- NestJS
- Prisma + SQLite
- Swagger

**Resultado**:
```
POST /ouija/ask
‚Üí Busca en SQLite
‚Üí Retorna respuesta m√≠stica
```

**¬øPor qu√© empezar aqu√≠?**
- Base s√≥lida sin dependencias externas
- Sistema funcional desde d√≠a 1
- F√°cil de testear

---

### Iteraci√≥n 2: + Ollama (1-2 semanas)
**¬øQu√© agregas?** IA local que genera respuestas din√°micas

**Nuevas tecnolog√≠as**:
- Docker Compose
- Ollama (qwen2.5:0.5b)

**Resultado**:
```
POST /ouija/ask
‚Üí Intenta Ollama
  ‚îú‚îÄ ‚úì Respuesta generada por IA
  ‚îî‚îÄ ‚úó Fallback a SQLite
```

**¬øPor qu√© Ollama?**
- Gratis (sin costos por request)
- Privado (datos no salen de tu m√°quina)
- Sin rate limits

---

### Iteraci√≥n 3: + Groq (1 semana)
**¬øQu√© agregas?** API de IA ultra-r√°pida

**Nuevas tecnolog√≠as**:
- Groq API
- Rate limiting

**Resultado**:
```
POST /ouija/ask
‚Üí Intenta Groq (2s)
  ‚îú‚îÄ ‚úì Respuesta r√°pida
  ‚îî‚îÄ ‚úó Intenta Ollama (20s)
      ‚îú‚îÄ ‚úì Respuesta local
      ‚îî‚îÄ ‚úó SQLite (50ms)
```

**¬øPor qu√© Groq?**
- Velocidad extrema (500 tokens/s)
- Free tier generoso
- Modelos grandes (Llama 3.1 8B)

---

### Iteraci√≥n 4: Deploy Koyeb (1 semana)
**¬øQu√© agregas?** Sistema en producci√≥n con CI/CD

**Nuevas tecnolog√≠as**:
- Dockerfile multi-stage
- GitHub Actions
- Koyeb PaaS

**Resultado**:
```
Push a GitHub
  ‚Üì
GitHub Actions (CI)
  ‚îú‚îÄ Tests
  ‚îú‚îÄ Lint
  ‚îî‚îÄ Build
      ‚Üì
Koyeb Auto-deploy
  ‚Üì
https://ouija-backend.koyeb.app
```

**¬øPor qu√© Koyeb?**
- Free tier permanente
- Docker nativo
- Deploy autom√°tico

---

## Arquitectura Final

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   USUARIO FRONTEND                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              NestJS Backend (Koyeb)                  ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ OuijaController                            ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   POST /ouija/ask                          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   GET  /health                             ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ   GET  /dashboard                          ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ             ‚îÇ                                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ OuijaService                               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                             ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  1Ô∏è‚É£ Try GroqService                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ     ‚îú‚îÄ API Call (timeout 10s)              ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ     ‚îî‚îÄ Success: 70% casos                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                             ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  2Ô∏è‚É£ Try OllamaService                      ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ     ‚îú‚îÄ Health check                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ     ‚îú‚îÄ Generate (timeout 30s)              ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ     ‚îî‚îÄ Success: 25% casos                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                             ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  3Ô∏è‚É£ FallbackService                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ     ‚îú‚îÄ Query SQLite                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ     ‚îî‚îÄ Success: 5% casos                   ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì              ‚Üì              ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Groq   ‚îÇ    ‚îÇ Ollama   ‚îÇ   ‚îÇ SQLite  ‚îÇ
    ‚îÇ Cloud  ‚îÇ    ‚îÇ Local    ‚îÇ   ‚îÇ Local   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Checklist de Progreso

### Preparaci√≥n
- [ ] Node.js 20+ instalado
- [ ] Docker instalado
- [ ] Git configurado
- [ ] Editor (VSCode recomendado)
- [ ] Cuenta GitHub creada
- [ ] Cuenta Koyeb creada (para Iteraci√≥n 4)
- [ ] API Key Groq obtenida (para Iteraci√≥n 3)

### Iteraci√≥n 1
- [ ] Prisma schema entendido
- [ ] Seed ejecutado (50+ respuestas)
- [ ] FallbackService implementado
- [ ] Tests unitarios > 80%
- [ ] Swagger en /api/docs
- [ ] Docker Compose local
- [ ] Health endpoint funcional

### Iteraci√≥n 2
- [ ] Ollama corriendo en Docker
- [ ] OllamaService mejorado
- [ ] Retry logic + Circuit breaker
- [ ] Health checks implementados
- [ ] Logging estructurado
- [ ] Tests de integraci√≥n

### Iteraci√≥n 3
- [ ] Groq API key configurada
- [ ] GroqService mejorado
- [ ] Triple fallback funcional
- [ ] Rate limiting implementado
- [ ] Dashboard m√©tricas
- [ ] Tests E2E

### Iteraci√≥n 4
- [ ] Dockerfile multi-stage
- [ ] GitHub Actions CI/CD
- [ ] Deploy Koyeb exitoso
- [ ] Variables entorno seguras
- [ ] Health checks producci√≥n
- [ ] Documentaci√≥n completa

## Comandos Esenciales

### Desarrollo
```bash
# Instalar dependencias
npm install

# Generar Prisma client
npx prisma generate

# Ejecutar migraciones
npx prisma migrate dev

# Seedear base de datos
npm run prisma:seed

# Ver base de datos (UI)
npx prisma studio

# Modo desarrollo (hot reload)
npm run start:dev

# Build para producci√≥n
npm run build

# Ejecutar producci√≥n
npm run start:prod
```

### Testing
```bash
# Tests unitarios
npm run test

# Tests en watch mode
npm run test:watch

# Coverage
npm run test:cov

# Tests E2E
npm run test:e2e
```

### Docker
```bash
# Levantar todo
docker-compose up

# Levantar en background
docker-compose up -d

# Ver logs
docker-compose logs -f

# Reconstruir
docker-compose up --build

# Detener
docker-compose down

# Limpiar todo
docker-compose down -v
```

### Git
```bash
# Crear rama feature
git checkout -b feature/iteracion-1

# Commits at√≥micos
git add .
git commit -m "feat: implement FallbackService"

# Push
git push origin feature/iteracion-1

# Merge a main
git checkout main
git merge feature/iteracion-1
```

## Endpoints de la API

### POST /ouija/ask
Consultar al esp√≠ritu de la Ouija

**Request**:
```json
{
  "question": "¬øEncontrar√© el amor?",
  "personality": "wise",
  "language": "es"
}
```

**Response**:
```json
{
  "success": true,
  "data": {
    "question": "¬øEncontrar√© el amor?",
    "response": "El amor verdadero no se busca...",
    "personality": "wise",
    "language": "es",
    "category": "love",
    "source": "groq",
    "model": "llama-3.1-8b-instant",
    "responseTime": 1543
  }
}
```

### GET /health
Estado del sistema

**Response**:
```json
{
  "status": "ok",
  "timestamp": "2025-10-17T12:00:00.000Z",
  "version": "1.0.0",
  "checks": {
    "database": { "status": "ok", "count": 54 },
    "ollama": { "status": "ok", "available": true },
    "groq": { "status": "ok", "available": true }
  }
}
```

### GET /dashboard
M√©tricas y estad√≠sticas

**Response**:
```json
{
  "timestamp": "2025-10-17T12:00:00.000Z",
  "services": {
    "groq": {
      "healthy": true,
      "rateLimit": { "remaining": 27, "nextRefill": 45000 }
    },
    "ollama": { "healthy": true, "model": "qwen2.5:0.5b" },
    "database": { "totalResponses": 54 }
  },
  "cache": { "size": 12, "questions": [...] }
}
```

## Recursos de Aprendizaje

### Documentaci√≥n Oficial
- **NestJS**: https://docs.nestjs.com/
- **Prisma**: https://www.prisma.io/docs
- **Ollama**: https://github.com/ollama/ollama
- **Groq**: https://console.groq.com/docs
- **Docker**: https://docs.docker.com/

### Videos Recomendados
- NestJS Crash Course (60 min)
- Prisma in 100 Seconds (2 min)
- Docker for Beginners (2h)
- REST APIs with NestJS (45 min)

### Pr√°ctica
1. Implementa Iteraci√≥n 1 siguiendo [PLAN.md](./iteracion-1/PLAN.md)
2. Lee [APRENDIZAJE.md](./APRENDIZAJE.md) para conceptos
3. Experimenta con diferentes configuraciones
4. Contribuye mejoras al proyecto

## Troubleshooting Com√∫n

### Prisma no genera client
```bash
npx prisma generate
# Si falla, borrar y regenerar:
rm -rf node_modules/.prisma
npm install
npx prisma generate
```

### Ollama no responde
```bash
# Verificar que est√° corriendo
curl http://localhost:11434/api/tags

# Ver logs
docker-compose logs ollama

# Reiniciar
docker-compose restart ollama
```

### Tests fallan
```bash
# Limpiar cach√© Jest
npm run test -- --clearCache

# Verificar variables entorno
cat .env.test

# Ver logs detallados
npm run test -- --verbose
```

### Build falla
```bash
# Limpiar dist
rm -rf dist

# Reinstalar dependencias
rm -rf node_modules
npm install

# Build desde cero
npm run build
```

## M√©tricas de √âxito

### Por Iteraci√≥n
- **Funcionalidad**: Sistema desplegable 100%
- **Tests**: > 80% coverage
- **Performance**: Targets alcanzados
- **Documentaci√≥n**: Completa

### Proyecto Completo
- **Tiempo**: 4-6 semanas
- **Velocidad**: 10-15 pts/semana
- **Features**: 17 implementadas
- **Tests**: 29+ pasando
- **Uptime**: > 99% en producci√≥n

## Siguiente Paso

1. **Ahora**: Lee [README.md](./README.md) para visi√≥n completa
2. **Luego**: Lee [ROADMAP.md](./ROADMAP.md) para timeline
3. **Despu√©s**: Lee [APRENDIZAJE.md](./APRENDIZAJE.md) para conceptos
4. **Finalmente**: Empieza [Iteraci√≥n 1 - PLAN.md](./iteracion-1/PLAN.md)

---

**¬°Listo para empezar!** üöÄ

```bash
cd backend-simple
npm install
npm run start:dev
# ‚Üí Sistema corriendo en http://localhost:3000
# ‚Üí Swagger en http://localhost:3000/api/docs
```
